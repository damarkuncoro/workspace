<!--
  Template: index.html.erb
  Tujuan: Halaman index untuk daftar Issues nested pada Employee.
  Catatan: Mengasumsikan controller menyediakan @employee dan @issues.
-->

<%# Bangun actions_html terlebih dahulu menggunakan capture untuk menghindari nested ERB %>
<% actions_html = capture do %>
  <%= link_to new_protected_employee_issue_path(@employee), class: 'kt-btn kt-btn-primary' do %>
    <i class="ki-filled ki-plus"></i> New Issue
  <% end %>
<% end %>

<%= render 'protected/shared/partials/page_header',
  title: 'Employee Issues',
  subtitle: (@employee&.respond_to?(:person_name) ? @employee.person_name : 'Employee'),
  actions_html: actions_html %>

<%= kt_card do %>
  <%= kt_card_content do %>
    <%= render partial: 'protected/issues/employees/partials/table',
      locals: {
        records: (@issues || @issues_employees || []),
        namespace: :protected,
        employee: @employee
      } %>
  <% end %>
<% end %>