<%#
  Partial: Roles Table
  Tujuan: Menampilkan daftar Roles menggunakan kt_card + kt_table.
  Prinsip: SRP & KISS â€” partial independen, menerima locals agar tidak bergantung instance variables.
  Locals yang diharapkan:
    - records: koleksi record (Array/ActiveRecord::Relation)
    - namespace: simbol namespace routes, contoh: :protected
    - resource_singular: simbol singular resource, contoh: :role
    - resource_plural: simbol plural resource, contoh: :roles
<% end %>


<%= kt_card do %>
  <%= kt_card_content do %>
    <%# Guard: gunakan present? agar aman saat koleksi nil %>
    <% if (records || []).present? %>
      <div class="kt-scrollable-x-auto">
        <%= kt_table(class: 'kt-table-border') do %>
          <thead>
            <tr>
              <th><%= kt_table_col_label { 'Name' } %></th>
              <th><%= kt_table_col_label { 'Created At' } %></th>
              <th class="w-[180px]"><%= kt_table_col_label { 'Actions' } %></th>
            </tr>
          </thead>
          <tbody>
            <% (records || []).each do |record| %>
              <tr>
                <td>
                  <div class="text-sm font-medium text-foreground"><%= record.respond_to?(:name) ? record.name : record.try(:title) || record.id %></div>
                </td>
                <td>
                  <div class="text-sm text-secondary-foreground"><%= record.try(:created_at) ? l(record.created_at) : '-' %></div>
                </td>
                <td>
                  <% if (record.respond_to?(:persisted?) && record.persisted?) || record.try(:id).present? %>
                    <div class="flex gap-2">
                      <%= link_to polymorphic_path([namespace, record]), class: 'kt-btn kt-btn-sm kt-btn-outline' do %>
                        <i class="ki-filled ki-eye"></i>
                      <% end %>
                      <%= link_to edit_polymorphic_path([namespace, record]), class: 'kt-btn kt-btn-sm kt-btn-outline' do %>
                        <i class="ki-filled ki-pencil"></i>
                      <% end %>
                    </div>
                  <% else %>
                    <span class="text-sm text-muted-foreground">-</span>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        <% end %>
      </div>
    <% else %>
      <div class="text-center py-8">
        <div class="flex flex-col items-center gap-4">
          <i class="ki-filled ki-question text-4xl text-muted-foreground"></i>
          <h3 class="text-lg font-medium text-foreground">No roles found</h3>
          <p class="text-sm text-secondary-foreground">Create your first role to get started.</p>
          <%= link_to new_polymorphic_path([namespace, resource_singular]), class: 'kt-btn kt-btn-primary' do %>
            <i class="ki-filled ki-plus"></i>
            New Role
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>

  <%= kt_card_footer(justify: 'justify-start') do %>
    <%= link_to polymorphic_path([namespace, resource_plural]), class: 'kt-btn kt-btn-outline' do %>
      <%= raw('<i class="ki-filled ki-arrow-left"></i> Back to Roles') %>
    <% end %>
  <% end %>
<% end %>